
---
title: "K-Nearest Neighbour Model"

---


```{r setup, include=FALSE}
library("class")
library("gmodels")
```

We will be using the iris data set for this example.
```{r}
knn_model_data = model_data[c(2, 5:7,12)]

knn_model_data = na.omit(knn_model_data)

str(knn_model_data)

View(knn_model_data)

```

Let's split the iris dataset into training and test set.
```{r}
train_index <- sample(1:nrow(knn_model_data), 0.5 * nrow(knn_model_data))
train.set <- knn_model_data[train_index,]
test.set  <- knn_model_data[-train_index,]
```

Now, we remove the Species column from our training and test datasets.
```{r}
train.set_new <- train.set[-5]
test.set_new <- test.set[-5]
```

Now, we store the labels from our training and test datasets.
```{r}
model_train_labels <- knn_model_data$pilot_nonpilot 
model_test_labels <- test.set$pilot_nonpilot
```

For k=3, let's make our prediction on the test set.
```{r}

model_knn_prediction <- knn(train = train.set_new, test = test.set_new, cl = model_train_labels , k = 3) 

dim(train.set_new)
dim(test.set_new)
length(model_train_labels)
```

Let's see the confusion matrix.
```{r}
CrossTable(x=model_test_labels, y=model_knn_prediction, prop.chisq=FALSE)
```

For k=11, let's make our prediction on the test set.
```{r}
model_knn_prediction <- knn(train = train.set_new, test = test.set_new, cl= model_train_labels, k = 11) 
```

Let's see the confusion matrix.
```{r}
CrossTable(x=model_test_labels, y=model_knn_prediction, prop.chisq=FALSE)
```
